server {
  listen 80;
  server_name _;

  location / {
    root /usr/share/nginx/html;
    try_files $uri /index.html;
    add_header Cache-Control "public, max-age=600";
  }

  location /ops/healthz {
    return 200 'ok';
  }

  location /ws/telemetry {
    proxy_pass http://telemetry-gateway:8000/ws/telemetry;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "Upgrade";
    proxy_read_timeout 60s;
    add_header Cache-Control "no-store";
  }

  location /metrics {
    proxy_pass http://telemetry-gateway:8000/metrics;
    add_header Cache-Control "no-store";
  }
}
