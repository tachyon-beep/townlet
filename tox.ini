[tox]
envlist = refactor
skipsdist = true

[testenv]
setenv =
    VIRTUALENV_APP_DATA = {toxworkdir}/.app-data
passenv = *
allowlist_externals = pytest
commands = pytest \
    tests/test_world_local_view.py \
    tests/test_world_nightly_reset.py \
    tests/test_world_queue_integration.py \
    tests/test_world_rivalry.py \
    tests/test_console_auth.py \
    tests/test_console_commands.py \
    tests/test_console_dispatcher.py \
    tests/test_console_events.py \
    tests/test_console_promotion.py \
    tests/test_telemetry_client.py \
    tests/test_telemetry_jobs.py \
    tests/test_telemetry_narration.py \
    tests/test_telemetry_new_events.py \
    tests/test_telemetry_stream_smoke.py \
    tests/test_telemetry_summary.py \
    tests/test_telemetry_transport.py \
    tests/test_telemetry_validator.py \
    tests/test_telemetry_watch.py

[testenv:refactor]
deps =
commands = {[testenv]commands}

[testenv:ml]
deps =
commands = pytest tests/policy/test_dto_ml_smoke.py -q

[testenv:docstrings]
deps =
commands = python scripts/check_docstrings.py src/townlet --min-module 95 --min-callable 40
